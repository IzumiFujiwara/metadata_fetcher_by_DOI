let
    // テーブルDOIからDOIを取得
    ソース = Excel.CurrentWorkbook(){[Name="入力DOI"]}[Content],
    変更された型 = Table.TransformColumnTypes(ソース,{{"DOI", type text}}),

    // カスタム関数 UnpaywallAuthorsQuery にDOIを渡してデータを取得
    呼び出されたカスタム関数 = Table.AddColumn(変更された型, "AuthorDetails", each getAuthorsFromUnpaywall([DOI])),
    // エラー行(データのない行)を削除
    エラーを削除 = Table.RemoveRowsWithErrors(呼び出されたカスタム関数, {"AuthorDetails"}),
    #"展開された AuthorDetails" = Table.ExpandTableColumn(エラーを削除, "AuthorDetails", {"order", "Author position", "is_corresponding", "Raw Author Name", "Raw Affiliation Strings"}, {"order", "Author position", "is_corresponding", "Raw Author Name", "Raw Affiliation Strings"})
in
    #"展開された AuthorDetails"